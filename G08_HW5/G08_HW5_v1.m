%18.4
clear
clc
%(a)--------------------------------------------------
x=[0,100,200,400,600,800,1000];
f=[0,0.8246,1,0.73576,0.40601,0.19915,0.09158];
h=[x(2)-x(1),x(3)-x(2),x(4)-x(3),x(5)-x(4),x(6)-x(5),x(7)-x(6)];
M1=[1,0,0,0,0,0,0;
    h(1),2*(h(1)+h(2)),h(2),0,0,0,0;
    0,h(2),2*(h(2)+h(3)),h(3),0,0,0;
    0,0,h(3),2*(h(3)+h(4)),h(4),0,0;
    0,0,0,h(4),2*(h(4)+h(5)),h(5),0;
    0,0,0,0,h(5),2*(h(5)+h(6)),h(6);
    0,0,0,0,0,0,1];
M2=[0;
    3*((f(3)-f(2))/h(2)-(f(2)-f(1))/h(1));
    3*((f(4)-f(3))/h(3)-(f(3)-f(2))/h(2));
    3*((f(5)-f(4))/h(4)-(f(4)-f(3))/h(3));
    3*((f(6)-f(5))/h(5)-(f(5)-f(4))/h(4));
    3*((f(7)-f(6))/h(6)-(f(6)-f(5))/h(5));
    0];
c=inv(M1)*M2

%求b的值 %求d的值
for i=1:1:6
    b(i)=(f(i+1)-f(i))/h(i)-h(i)*(2*c(i)+c(i+1))/3;
    d(i)=(c(i+1)-c(i))/3/h(i);
end

%求s的值
subplot(2,2,1)
for i=1:1:6
q=x(i):0.1:x(i+1);
s=f(i)+b(i)*(q-x(i))+c(i)*(q-x(i)).^2+d(i)*(q-x(i)).^3;
plot(q,s,'b')
hold on
end
axis([-inf,inf,0,1.5]);
title('自然伸出條件');

%(b)--------------------------------------------------
M1=[h(2),-(h(1)+h(2)),h(1),0,0,0,0;
    h(1),2*(h(1)+h(2)),h(2),0,0,0,0;
    0,h(2),2*(h(2)+h(3)),h(3),0,0,0;
    0,0,h(3),2*(h(3)+h(4)),h(4),0,0;
    0,0,0,h(4),2*(h(4)+h(5)),h(5),0;
    0,0,0,0,h(5),2*(h(5)+h(6)),h(6);
    0,0,0,0,h(6),-(h(5)+h(6)),h(5)];
c=inv(M1)*M2

%求b的值 %求d的值
for i=1:1:6
    b(i)=(f(i+1)-f(i))/h(i)-h(i)*(2*c(i)+c(i+1))/3;
    d(i)=(c(i+1)-c(i))/3/h(i);
end

subplot(2,2,2)
%求s的值
for i=1:1:6
q=x(i):0.1:x(i+1);
s=f(i)+b(i)*(q-x(i))+c(i)*(q-x(i)).^2+d(i)*(q-x(i)).^3;
plot(q,s,'k')
hold on
end
axis([-inf,inf,0,1.5]);
title('非結點');

%(c)--------------------------------------------------
subplot(2,2,3)
xx=linspace(0,1000);
vh=interp1(x,f,xx,'pchip');
plot(x,f,'o',xx,vh)
hold on
axis([-inf,inf,0,1.5]);
title('厄米特內插');

subplot(2,2,4)
x=0:0.1:1000;
f=(x/200).*exp(-x/200+1);
plot(x,f,'r')
hold on
axis([-inf,inf,0,1.5]);
title('題目給的方程式');


